![header](https://capsule-render.vercel.app/api?type=rect&color=auto&height=400&section=header&text=κ°„μ΄%20μλ™μ°¨%20ν”„λ΅μ νΈ&fontSize=60&animation=twinkling&desc=μ„λ² λ””λ“μ‹μ¤ν…%204μ΅°%20κΈ°λ§%20ν”„λ΅μ νΈ)
<br/>

### Contributors

|ν”„λ΅ν•„|ν•™λ²|μ—­ν• |
|:---:|:---:|:---|
|<a href="https://github.com/Dyoya/"><img src="https://avatars.githubusercontent.com/u/118094189?v=4" width="100px;" alt="Dyoya"/><br /><sub><b>Dyoya (κΉ€ν•λ―Ό)</b></sub></a><br /> <a href="https://github.com/Dyoya/EmbeddedProject/commits?author=Dyoya" title="Commit Log">π’»</a>|20190348|- μ—­ν• <br>- μ—­ν• |
|<a href="https://github.com/ParkSGye/"><img src="https://avatars.githubusercontent.com/u/113571828?v=4" width="100px;" alt="ParkSGye"/><br /><sub><b>ParkSGye (λ°•μ„±κ·)</b></sub></a><br /> <a href="https://github.com/Dyoya/EmbeddedProject/commits?author=ParkSGye" title="Commit Log">π’»</a>|20190452|- μ—­ν• <br>- μ—­ν• |
|<a href="https://github.com/user71309876/"><img src="https://avatars.githubusercontent.com/u/93814905?v=4" width="100px;" alt="user71309876"/><br /><sub><b>user71309876 (λ°•μ¬ν„)</b></sub></a><br /> <a href="https://github.com/Dyoya/EmbeddedProject/commits?author=user71309876" title="Commit Log">π’»</a>|20180474|- μ—­ν• <br>- μ—­ν• |
|<a href="https://github.com/dwgns/"><img src="https://avatars.githubusercontent.com/u/67849875?v=4" width="100px;" alt="dwgns"/><br /><sub><b>dwgns (μ•μ§€ν›)</b></sub></a><br /> <a href="https://github.com/Dyoya/EmbeddedProject/commits?author=dwgns" title="Commit Log">π’»</a>|20190685|- μ—­ν• <br>- μ—­ν• |

# List
1. [μ•„μ΄λ””μ–΄ μ†κ°](https://github.com/Dyoya/EmbeddedProject#μ•„μ΄λ””μ–΄-μ†κ°)
2. [μ „μ²΄ μ‹μ¤ν… κµ¬μ΅°](https://github.com/Dyoya/EmbeddedProject#μ „μ²΄-μ‹μ¤ν…-κµ¬μ΅°)
3. [νλ΅ κµ¬μ΅°λ„](https://github.com/Dyoya/EmbeddedProject#νλ΅-κµ¬μ΅°λ„)
5. [μ ν• μ΅°κ±΄](https://github.com/Dyoya/EmbeddedProject#μ ν•-μ΅°κ±΄)
6. [κ°€μ‚°μ  μ”μ†](https://github.com/Dyoya/EmbeddedProject#κ°€μ‚°μ -μ”μ†)
7. [κµ¬ν„ λ‚΄μ©](https://github.com/Dyoya/EmbeddedProject#κµ¬ν„-λ‚΄μ©)
8. [μ‹¤ν–‰ λ°©λ²•](https://github.com/Dyoya/EmbeddedProject#μ‹¤ν–‰-λ°©λ²•)
9. [μ‚¬μ©λ²•](https://github.com/Dyoya/EmbeddedProject#μ‚¬μ©λ²•)
10. [κ°λ° μΌμ •](https://github.com/Dyoya/EmbeddedProject#κ°λ°-μΌμ •)
11. [μ°Έκ³ λ¬Έν—](https://github.com/Dyoya/EmbeddedProject#μ°Έκ³ λ¬Έν—)

# μ•„μ΄λ””μ–΄ μ†κ°
 **κ°„μ΄ μλ™μ°¨ ν”„λ΅μ νΈ**λ” μ°¨λ‰μ μ—¬λ¬ μƒν™©λ³€ν™”(ex.μ¨λ„, μ°¨λ‰λ‚΄λ¶€ μμ„, κ°€μ¤ λ†λ„, NFC read)λ¥Ό κ°μ§€ν•μ—¬ ν™•λ³΄ν• λ°μ΄ν„°λ¥Ό μ‚¬μ©μμ μ¤λ§νΈν° μ–΄ν”μ— μ†΅μ‹ ν•λ” ν”„λ΅κ·Έλ¨μ΄λ‹¤. λ°μ΄ν„°μ—μ„ κ³Όλ„ν• λ³€ν™”κ°€ μƒκΈΈ κ²½μ° ν”„λ΅κ·Έλ¨μ€ μ‚¬μ©μμ μ¤λ§νΈν°μ— μ•λμ„ λ°μƒμ‹ν‚¤λ©°, NFC λ¦¬λ”κΈ°μ— νƒ€ μ‚¬μ©μμ μΉ΄λ“ν‚¤(νΉμ€ λ¦¬λ”κΈ°μ— μ²μ λ“±λ΅ν•λ” μΉ΄λ“ν‚¤)μ— λ€ν•΄ μ°¨λ‰ λ‚΄λ¶€ λ¶€μ €λ΅ κ²½κ³ λ¥Ό μΈλ¦¬λ©° μ‚¬μ©μμ μ¤λ§νΈν°μ— κ²½κ³  μ‹ νΈλ¥Ό λ³΄λ‚Έλ‹¤.

# μ „μ²΄ μ‹μ¤ν… κµ¬μ΅°
 **μ¨μµλ„ μ„Όμ„**μ—μ„ μ¨λ„, **μμ„ μ„Όμ„**, **κ°€μ¤ μ„Όμ„**, **NFC λ¦¬λ”κΈ°**κ°€ λ°μ΄ν„°λ¥Ό μ½μ–΄ λΌμ¦λ² λ¦¬ νμ΄κ°€ λ°›λ”λ‹¤. λΌμ¦λ² λ¦¬ νμ΄λ” ν•΄λ‹Ή λ°μ΄ν„°λ¥Ό ν•λ‚μ **JSON ν•μ‹**μΌλ΅ μΆ…ν•©ν•μ—¬ μ„λ²„λ΅ μ „μ†΅ν•λ‹¤. μ„λ²„μ **DB**μ— κ°’μ΄ μ €μ¥λλ©°, μ¤λ§νΈν°μ **μ•λ“λ΅μ΄λ“ μ•±**μ€ μ„λ²„μ—μ„ λ°μ΄ν„°λ¥Ό μ½μ–΄ μ‚¬μ©μμ—κ² λ³΄μ—¬μ¤€λ‹¤. NFCκ°€ μ²μ μΈμ‹λ κ²½μ°λ” μ‚¬μ©μκ°€ μ¤λ§νΈν°μ„ ν†µν•΄ **κ²½κ³  μ‹ νΈ**λ¥Ό μ„λ²„λ΅ λ³΄λ‚Ό μ μλ‹¤. λΌμ¦λ² λ¦¬ νμ΄λ” μ„λ²„λ΅λ¶€ν„° κ²½κ³  μ‹ νΈλ¥Ό λ°›μ•„ λ¶€μ €λ¥Ό μΈλ ¤ κ²½κ³ ν•  μ μλ‹¤.
 
![μ‹μ¤ν… κµ¬μ΅°λ„](./img/μ‹μ¤ν…κµ¬μ΅°λ„.jpg)

# νλ΅ κµ¬μ΅°λ„
 **μ¨μµλ„ μ„Όμ„**λ” μ½μ€ λ°μ΄ν„°λ¥Ό λ””μ§€ν„Έ μ‹ νΈλ΅ μ „μ†΅ν•  μ μλ‹¤. κ·Έλμ„, λΌμ¦λ² λ¦¬ νμ΄μ GPIO ν•€μ— μ§μ ‘ μ—°κ²°ν–λ‹¤. **μμ„ μ„Όμ„**λ” μ•„λ‚ λ΅κ·Έ μ‹ νΈλ¥Ό μ „μ†΅ν•κΈ° λ•λ¬Έμ— ADC μ»¨λ²„ν„°λ¥Ό μ‚¬μ©ν•΄ λΌμ¦λ² λ¦¬ νμ΄μ— μ—°κ²°ν–λ‹¤. **κ°€μ¤ μ„Όμ„**λ” λ””μ§€ν„Έ μ‹ νΈλ¥Ό μ „μ†΅ν•  μ μμ§€λ§, λ””μ§€ν„Έ μ‹ νΈλ” 0κ³Ό 1λ΅ κ°€μ¤ κ°μ§€ μ—¬λ¶€λ§μ΄ μκΈ° λ•λ¬Έμ— μ•„λ‚ λ΅κ·Έ μ‹ νΈλ¥Ό ADC μ»¨λ²„ν„°λ¥Ό μ΄μ©ν•΄ λΌμ¦λ² λ¦¬ νμ΄μ™€ μ—°κ²°ν–λ‹¤. **NFC λ¦¬λ”κΈ°**λ” UART ν†µμ‹ μ„ μ‚¬μ©ν•λ―€λ΅ λΌμ¦λ² λ¦¬ νμ΄μ TX, RXν•€κ³Ό μ—°κ²°ν–λ‹¤.
 
![νλ΅ κµ¬μ΅°λ„](./img/νλ΅κµ¬μ΅°λ„.jpg)

# μ ν• μ΅°κ±΄
## Thread
 λ‚΄μ©λ‚΄μ©

## Mutex
 λ‚΄μ©λ‚΄μ©

# κ°€μ‚°μ  μ”μ†
> μ„λ²„λ¥Ό ν†µν• λΌμ¦λ² λ¦¬ νμ΄μ™€ μ¤λ§νΈν° ν†µμ‹ 
> 
> λ‹¤λ¥Έ μμ—…μ λ‚΄μ©κ³Ό λ³‘ν•©ν• μ„λ²„ κ°λ° λ° μ•λ“λ΅μ΄λ“ μ•± κ°λ°

# κµ¬ν„ λ‚΄μ©
## 1. RasberryPi
 ν—¤λ” νμΌ **common.h**λ¥Ό λ§λ“¤μ–΄ μ—¬λ¬ μ½”λ“λ¥Ό ν•λ‚λ΅ ν•©μ³¤λ‹¤. common.hλ” κ³µμ  λ³€μ λ° ν•¨μκ°€ μ„ μ–Έλμ–΄ μκ³ , common.cμ—λ” μ •μλμ–΄ μλ‹¤. 
 
- **temperature.c**  
 μ¨μµλ„ μ„Όμ„λ¥Ό μ‚¬μ©ν•λ” temperatureSensorFun(void*) ν•¨μκ°€ μλ” μ½”λ“λ‹¤. 

## 2. Server
 λ°μ΄ν„°λ² μ΄μ¤μ 4κ°€μ§€ μ„Όμ„κ°’μ„ λ°›μ•„λ“¤μΌ μ μκ² temperature, water, gas, nfcμ μ†μ„±μΌλ΅ κµ¬μ„±ν–λ‹¤.

![db desc](./img/db.png)

μ•„λλ” μ„Όμ„κ°’μ„ DBμ— μ €μ¥ν•λ” μ½”λ“λ‹¤. λΌμ¦λ² λ¦¬νμ΄λ” CURLμ„ μ΄μ©ν•μ—¬ νΈμ¤νΈ μ£Όμ†μ— μ ‘κ·Όν•μ—¬ μ„Όμ„κ°’μ„ POST λ°©μ‹μΌλ΅ μ„λ²„μ— μ „λ‹¬ν•λ‹¤. κ·Έλ¦¬κ³  μ„λ²„λ” λ°›μ€ κ°’μ„ μ΄μ©ν•μ—¬ DBλ¥Ό κ°±μ‹ ν•λ‹¤. μ„Όμ„κ°’μ€ κ°€μ¥ μµμ‹ μ κ°’λ§ μ ν¨ν•λ‹¤λ” νΉμ§•μ΄ μμ–΄ νν”μ„ λ„μ μ‹ν‚¤μ§€ μ•κ³  1μ—΄μ νν”κ°’μ„ κ°±μ‹ μ‹ν‚¤λ„λ΅ ν–λ‹¤.

```javascript
app.post("/sensor", (req, res) => {
  const sql = "update sensor set temperature=?, water=?, gas=?, nfc=?";
  var params = [
    req.body.temperature,
    req.body.water,
    req.body.gas,
    req.body.nfc,
  ];
  console.log(params);
  db.query(sql, params, (err, rows, fields) => {
    console.log(rows);
    if (err) {
      res.json({ result: "error" });
      return console.log(err);
    }
    res.json(rows);
  });
});
```

μ•„λλ” μ•±μ—μ„ μ„Όμ„μ κ°’μ„ λ°›μ•„μ¤λ” μ½”λ“λ‹¤. μ•±μ€ Retrofitμ„ μ‚¬μ©ν•μ—¬ GET λ°©μ‹μΌλ΅ κ°’μ„ λ°›μ•„μ¨λ‹¤.

```javascript
app.get("/sensor", (req, res) => {
  const sql = "select * from sensor";
  db.query(sql, (err, rows) => {
    if (err) {
      res.json({ result: "error" });
      return console.log(err);
    }
    res.json(rows);
  });
});
```

μ•„λλ” λΌμ¦λ² λ¦¬νμ΄μ—μ„ μ•λ flagκ°’μ„ λ°›μ•„μ¤λ” μ½”λ“λ‹¤. μ•λ flagκ°’μ΄ trueμ΄λ©΄ μ•λμ„ μΈλ¦¬λΌλ” json ν•μ‹μ λ°μ΄ν„°λ¥Ό λ³΄λ‚Έλ‹¤.

```javascript
app.get("/buzzer", (req, res) => {
  if (result) {
    res.json({ warning: "noise" });
    result = false;
  } else {
    res.json({ warning: "quiet" });
  }
  console.log(result);
});
```

μ•„λλ” μ•±μ—μ„ μ ν¨ν•μ§€ μ•μ€ NFCκ°€ μ ‘κ·Όν–μ„ λ• μ•λ flagκ°’μ„ λ³€κ²½ν•λ” μ½”λ“λ‹¤. μ•λ flagκ°’μ΄ trueμ΄λ©΄ λ¶€μ €λ¥Ό μΈλ¦¬κ³  falseμ΄λ©΄ λ¶€μ €λ¥Ό μΈλ¦¬μ§€ μ•λ”λ‹¤.

```javascript
app.get("/warning", (req, res) => {
  if (result == false) {
    result = true;
    res.json({ warning: "Get Ok" });
    console.log(result);
  }
});
```


## 3. Android App
 λ‚΄μ©λ‚΄μ©
 
## 4. Makefile
 λ‚΄μ©λ‚΄μ©

# μ‹¤ν–‰ λ°©λ²•
 ### λΌμ¦λ² λ¦¬νμ΄ ν™κ²½
  1. wiringPi μ„¤μΉ
  ```
  git clone https://github.com/WiringPi/WiringPi.git
  cd WiringPi
  git pull origin
  ./bulid
  ```
  μ„¤μΉκ°€ μ„±κ³µμ μΈμ§€ ν™•μΈν•©λ‹λ‹¤
  ```
  gpio -v
  ```

   2. curl μ„¤μΉ
  ```
  sudo apt update
  sudo apt install -y curl
  ```
  μ„¤μΉκ°€ λλ‚¬λ‹¤λ©΄ λ²„μ „μ„ ν™•μΈν•©λ‹λ‹¤.
  ```
  curl --version
  ```

  3. μ‹¤ν–‰ νμΌ λΉλ“
  ```
  cd RaspberryPi && make
  ```
  νμΌ μ‹¤ν–‰
  ```
  ./myprogram
  ```
### μ„λ²„ ν™κ²½
  1. node.js μ„¤μΉ
     [Node.js ν™νμ΄μ§€](https://nodejs.org/en/download) 
  2. μ„λ²„ μ‹¤ν–‰
  ```
  cd Server node && server.js
  ```


# μ‚¬μ©λ²•
μ΄ ν”„λ΅μ νΈλ” λ‹¤μ 4κ°€μ§€ μ£Όμ” μ„Όμ„λ¥Ό μ‚¬μ©ν•μ—¬ μΈ΅μ •λ κ°’μ„ μ‚¬μ©ν•λ‹¤.

### 1. NFC λ¦¬λ”
  NFC μΉ΄λ“λ¥Ό λ¦¬λ”κΈ°μ— νƒκ·Έν•λ‹¤. νƒκ·Έ μ‹ μ¤λ§νΈν° μ–΄ν”λ¦¬μΌ€μ΄μ…μ—μ„ μ•λμ΄ λ°μƒν•λ©° λ“±λ΅μ΄λ‚ μ·¨μ†λ¥Ό μ„ νƒν•  μ μλ‹¤. λν• νƒκ·Έ μ„±κ³µ μ‹ λ¶€μ €λ¥Ό ν†µν• μ²­κ°μ  ν”Όλ“λ°±μ΄ λ°μƒν•λ‹¤.
### 2. μ¨λ„ μ„Όμ„
  μ£ΌκΈ°μ μΌλ΅ μ¨λ„λ¥Ό μΈ΅μ •ν•λ‹¤. μΈ΅μ •λ κ°’μ€ μ¤λ§νΈν° μ–΄ν”λ¦¬μΌ€μ΄μ…μ μ¨λ„ μ„Όμ„ ν•­λ©μ„ ν†µν•΄ ν™•μΈν•  μ μλ‹¤.
### 3. μμ„ μ„Όμ„
  μ£ΌκΈ°μ μΌλ΅ μμ„λ¥Ό μΈ΅μ •ν•λ‹¤. λ§μ°¬κ°€μ§€λ΅ μ¤λ§νΈν° μ–΄ν”λ¦¬μΌ€μ΄μ…μ μμ„ μ„Όμ„ ν•­λ©μ„ ν†µν•΄ ν™•μΈν•  μ μλ‹¤.
### 4. κ°€μ¤ μ„Όμ„
  μ£ΌκΈ°μ μΌλ΅ κ°€μ¤ λ†λ„λ¥Ό μΈ΅μ •ν•λ‹¤. μ„μ™€ λ™μΌ.

μΈ΅μ •λ μ •λ³΄λ” λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥λλ©° μ €μ¥λ μ •λ³΄λ” μ¤λ§νΈν° μ–΄ν”λ¦¬μΌ€μ΄μ…μ„ ν†µν•΄ ν™•μΈν•  μ μλ‹¤. λ”°λΌμ„ ν”„λ΅κ·Έλ¨μ΄ μ‘λ™ν•κΈ° μ„ν•΄μ„λ” λ°μ΄ν„°λ² μ΄μ¤ μ„λ²„ κµ¬λ™ λ° μ¤λ§νΈν° μ–΄ν”λ¦¬μΌ€μ΄μ… μ„¤μΉλ¥Ό μ”κµ¬ν•λ‹¤.
NFCλ¥Ό μ μ™Έν• λ‚λ¨Έμ§€ μ„Όμ„λ“¤μ κ²½μ° νΉμ΄μ‚¬ν•­(λΉ„μ •μƒμ μΌλ΅ λ†’μ€ μ¨λ„ λ“±) λ°μƒ μ‹ μ¤λ§νΈν° μ–΄ν”λ¦¬μΌ€μ΄μ… ν™”λ©΄μ—μ„ κ° ν•­λ©μ— λ€ν•΄ λΉ¨κ°„μƒ‰μΌλ΅ κ°•μ΅° μ²λ¦¬λκ³  λ°±κ·ΈλΌμ΄λ“ κ²½κ³  μ•λ¦Όμ„ λ°μƒμ‹ν‚¨λ‹¤.


# κ°λ° μΌμ •
 μ•„λ μ‚¬μ§„μ€ 11μ›” 30μΌλ¶€ν„° 12μ›” 15μΌκΉμ§€μ κ°λ° μΌμ •μ΄λ‹¤. μ΄λ΅μƒ‰ μμ—­μ€ κΈ°μ΅΄μ— κ³„νν–λ λ¶€λ¶„μ΄κ³  λ€λ¶€λ¶„ λ§μ¶°μ„ κ°λ°λμ—λ‹¤. μ£Όν™©μƒ‰ μμ—­μ€ κΈ°κ°„ μ•μ— μ™„μ„±ν•μ§€ λ»ν•μ—¬ μ¶”κ°€λ΅ μ†μ”λ κΈ°κ°„μ„ ν‘μ‹ν• κ²ƒμ΄λ‹¤.

![κ°λ° μΌμ •](./img/κ°λ°μΌμ •2.jpg.png)


# μ°Έκ³ λ¬Έν—
[κ°€μ¤ μ„Όμ„(MQ-5)](https://m.blog.naver.com/elepartsblog/221528526035)

[MCP3208 ADC μ»¨λ²„ν„° μ‚¬μ©ν•κΈ°](https://diymaker.tistory.com/155)

[MCP3008 + μμ„μ„Όμ„](https://blog.naver.com/PostView.naver?blogId=roboholic84&logNo=220416082742)

[NFC Reader(PN532)](https://m.blog.naver.com/tiled12/221794166065)

[μ¨μµλ„ μ„Όμ„](https://blog.naver.com/PostView.naver?blogId=dokkosam&logNo=222162911335)

[CURL λ…λ Ήμ–΄ μ‚¬μ©λ²• μ •λ¦¬](https://inpa.tistory.com/entry/LINUX-%F0%9F%93%9A-CURL-%EB%AA%85%EB%A0%B9%EC%96%B4-%EC%82%AC%EC%9A%A9%EB%B2%95-%EB%8B%A4%EC%96%91%ED%95%9C-%EC%98%88%EC%A0%9C%EB%A1%9C-%EC%A0%95%EB%A6%AC)
